<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KukaiCoreSwift - FeeEstimatorService</title>
    <link rel="stylesheet" type="text/css" href="https://kukai-core-swift.kukai.app/all.css" media="all" />
</head>
<body>
    <header>
        <a href="https://kukai-core-swift.kukai.app/">
            <strong>
                KukaiCoreSwift
            </strong>
            <span>Documentation</span>
        </a>
    </header>

    <!--
    <form class="search">
        <input type="search" placeholder="Search" />
    </form>
    -->

    <nav>
        <div class="wrapper">
            <h2>On This Page</h2>
            <ol><li><a href="#relationships">Relationships</a><ul><li><a href="#relationships">Nested Types</a></li></ul></li><li><a href="#initializers">Initializers</a><ul><li class="initializer"><a href="#feeestimatorservice.init(config:operationservice:networkservice:)">init(config:​operation​Service:​network​Service:​)</a></li></ul></li><li><a href="#properties">Properties</a><ul><li class="variable"><a href="#feeestimatorservice.defaultsignature">default​Signature</a></li><li class="variable"><a href="#feeestimatorservice.defaultsignaturehex">default​Signature​Hex</a></li><li class="variable"><a href="#feeestimatorservice.config">config</a></li><li class="variable"><a href="#feeestimatorservice.operationservice">operation​Service</a></li><li class="variable"><a href="#feeestimatorservice.networkservice">network​Service</a></li></ul></li><li><a href="#methods">Methods</a><ul><li class="function"><a href="#feeestimatorservice.estimate(operations:operationmetadata:constants:walletaddress:base58encodedpublickey:completion:)">estimate(operations:​operation​Metadata:​constants:​wallet​Address:​base58Encoded​Public​Key:​completion:​)</a></li><li class="function"><a href="#feeestimatorservice.extractfees(fromoperationresponse:forgedhash:withconstants:)">extract​Fees(from​Operation​Response:​forged​Hash:​with​Constants:​)</a></li><li class="function"><a href="#feeestimatorservice.feeforgas(_:)">fee​For​Gas(_:​)</a></li><li class="function"><a href="#feeestimatorservice.feeforstorage(_:numberofoperations:)">fee​For​Storage(_:​number​OfOperations:​)</a></li><li class="function"><a href="#feeestimatorservice.feeforburn(_:withconstants:)">fee​For​Burn(_:​with​Constants:​)</a></li><li class="function"><a href="#feeestimatorservice.nanoteztoxtz(_:)">nano​Tezto​XTZ(_:​)</a></li><li class="function"><a href="#feeestimatorservice.fee(forgaslimit:forgedhexstring:numberofoperations:)">fee(for​Gas​Limit:​forged​Hex​String:​number​OfOperations:​)</a></li><li class="function"><a href="#feeestimatorservice.addgassafetymarginto(gasused:)">add​Gas​Safety​Margin​To(gas​Used:​)</a></li></ul></li></ol>
        </div>
    </nav>

    <main>
        <article>
            <h1>
    <small>Class</small>
    <code class="name">Fee​Estimator​Service</code>
</h1>

<div class="declaration">
<pre class="highlight"><code><html><body><span class="keyword">public</span> <span class="keyword">class</span> <span class="type">FeeEstimatorService</span>  </body></html></code></pre>
</div>
<div class="summary" role="doc-abstract">
    <p>An object allowing developers to automatically estimate the necessary fee per Operation to ensure it will be accpeted by a Baker.
This avoids the need to ask users to enter a fee, which is not a very user friendly approach as most users wouldn't know what is required.</p>

</div>
<section id="relationships">
    <h2 hidden>Relationships</h2>
        
        <h3>Nested Types</h3>
<dl>
    <dt class="structure"><code><a href="https://kukai-core-swift.kukai.app/FeeEstimatorService_FeeConstants">FeeEstimatorService.FeeConstants</a></code></dt>
<dd><p>Constants needed to compute a fee</p>
</dd>
<dt class="enumeration"><code><a href="https://kukai-core-swift.kukai.app/FeeEstimatorService_FeeEstimatorServiceError">FeeEstimatorService.FeeEstimatorServiceError</a></code></dt>
<dd><p>Various possible errors that can occur during an Estimation</p>
</dd>
<dt class="structure"><code><a href="https://kukai-core-swift.kukai.app/FeeEstimatorService_EstimationResult">FeeEstimatorService.EstimationResult</a></code></dt>
<dd></dd>
</dl>
</section>
    <section id="initializers">
        <h2>Initializers</h2>

        <div role="article" class="initializer" id="feeestimatorservice.init(config:operationservice:networkservice:)">
    <h3>
        <code><a href="#feeestimatorservice.init(config:operationservice:networkservice:)">init(config:​operation​Service:​network​Service:​)</a></code>
    </h3>
    <div class="declaration">
<pre class="highlight"><code><html><body><span class="keyword">public</span> <span class="keyword">init</span>(<span class="variable">config</span>: <a href="https://kukai-core-swift.kukai.app/TezosNodeClientConfig"><span class="type">TezosNodeClientConfig</span></a> = <span class="variable">TezosNodeClientConfig</span>(<span class="variable">withDefaultsForNetworkType</span>: .<span class="variable">mainnet</span>), <span class="variable">operationService</span>: <a href="https://kukai-core-swift.kukai.app/OperationService"><span class="type">OperationService</span></a>, <span class="variable">networkService</span>: <a href="https://kukai-core-swift.kukai.app/NetworkService"><span class="type">NetworkService</span></a>)  </body></html></code></pre>
</div>
<div class="summary" role="doc-abstract">
    <p>Create a FeeEstimatorService that will allow developers to automatically create fees on the users behalf</p>

</div>
<h4>Parameters</h4>

<table class="parameters">
  <thead hidden>
  <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
  </tr>
  </thead>
  <tbody>
    <tr>
    <th>operation​Service</th>
    <td><code class="type">Operation​Service</code></td>
    <td><p>The <code>OperationService</code> used to perform the forging.</p>
</td>
</tr>
<tr>
    <th>network​Service</th>
    <td><code class="type">Network​Service</code></td>
    <td><p>The <code>NetworkService</code> that will handle the remote communication.</p>
</td>
</tr>
  </tbody>
</table>
</div>
    </section>
    <section id="properties">
        <h2>Properties</h2>

        <div role="article" class="variable" id="feeestimatorservice.defaultsignature">
    <h3>
        <code><a href="#feeestimatorservice.defaultsignature">default​Signature</a></code>
    </h3>
    <div class="declaration">
<pre class="highlight"><code><html><body><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">let</span> <span class="variable">defaultSignature</span>  </body></html></code></pre>
</div>
<div class="summary" role="doc-abstract">
    <p>The real signature is not needed for estimation, use the default &quot;Zero Signature&quot; instead</p>

</div>
</div>
<div role="article" class="variable" id="feeestimatorservice.defaultsignaturehex">
    <h3>
        <code><a href="#feeestimatorservice.defaultsignaturehex">default​Signature​Hex</a></code>
    </h3>
    <div class="declaration">
<pre class="highlight"><code><html><body><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">let</span> <span class="variable">defaultSignatureHex</span>  </body></html></code></pre>
</div>
</div>
<div role="article" class="variable" id="feeestimatorservice.config">
    <h3>
        <code><a href="#feeestimatorservice.config">config</a></code>
    </h3>
    <div class="declaration">
<pre class="highlight"><code><html><body><span class="keyword">public</span> <span class="keyword">let</span> <span class="variable">config</span>: <a href="https://kukai-core-swift.kukai.app/TezosNodeClientConfig"><span class="type">TezosNodeClientConfig</span></a></body></html></code></pre>
</div>
<div class="summary" role="doc-abstract">
    <p>The configuration object containing all the necessary settings to connect and communicate with the Tezos node</p>

</div>
</div>
<div role="article" class="variable" id="feeestimatorservice.operationservice">
    <h3>
        <code><a href="#feeestimatorservice.operationservice">operation​Service</a></code>
    </h3>
    <div class="declaration">
<pre class="highlight"><code><html><body><span class="keyword">public</span> <span class="keyword">let</span> <span class="variable">operationService</span>: <a href="https://kukai-core-swift.kukai.app/OperationService"><span class="type">OperationService</span></a></body></html></code></pre>
</div>
<div class="summary" role="doc-abstract">
    <p>The <code>OperationService</code> object that will perform forging, parsing, signing, preapply and injections of operations</p>

</div>
</div>
<div role="article" class="variable" id="feeestimatorservice.networkservice">
    <h3>
        <code><a href="#feeestimatorservice.networkservice">network​Service</a></code>
    </h3>
    <div class="declaration">
<pre class="highlight"><code><html><body><span class="keyword">public</span> <span class="keyword">let</span> <span class="variable">networkService</span>: <a href="https://kukai-core-swift.kukai.app/NetworkService"><span class="type">NetworkService</span></a></body></html></code></pre>
</div>
<div class="summary" role="doc-abstract">
    <p>The <code>NetworkService</code> that will handle the remote communication.</p>

</div>
</div>
    </section>
    <section id="methods">
        <h2>Methods</h2>

        <div role="article" class="function" id="feeestimatorservice.estimate(operations:operationmetadata:constants:walletaddress:base58encodedpublickey:completion:)">
    <h3>
        <code><a href="#feeestimatorservice.estimate(operations:operationmetadata:constants:walletaddress:base58encodedpublickey:completion:)">estimate(operations:​operation​Metadata:​constants:​wallet​Address:​base58Encoded​Public​Key:​completion:​)</a></code>
    </h3>
    <div class="declaration">
<pre class="highlight"><code><html><body><span class="keyword">public</span> <span class="keyword">func</span> <span class="function">estimate</span>(<span class="variable">operations</span>: [<a href="https://kukai-core-swift.kukai.app/Operation"><span class="type">Operation</span></a>], <span class="variable">operationMetadata</span>: <a href="https://kukai-core-swift.kukai.app/OperationMetadata"><span class="type">OperationMetadata</span></a>, <span class="variable">constants</span>: <a href="https://kukai-core-swift.kukai.app/NetworkConstants"><span class="type">NetworkConstants</span></a>, <span class="variable">walletAddress</span>: <span class="type">String</span>, <span class="variable">base58EncodedPublicKey</span>: <span class="type">String</span>, <span class="variable">completion</span>: <span class="attribute">@</span><span class="attribute">escaping</span> ((<span class="type">Result</span>&lt;<span class="type">EstimationResult</span>, <a href="https://kukai-core-swift.kukai.app/KukaiError"><span class="type">KukaiError</span></a>&gt;) -&gt; <span class="type">Void</span>))  </body></html></code></pre>
</div>
<div class="summary" role="doc-abstract">
    <p>Pass in an array of <code>Operation</code> subclasses (use <code>OperationFacotry</code> to create) to have the library estimate the cost of sending the transaction. Function will use local or remote forging based off config passed in.
If the supplied operations contain suggested fees (e.g. from a dApp) this function will estimate the fee and pick which ever is higher</p>

</div>
<h4>Parameters</h4>

<table class="parameters">
  <thead hidden>
  <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
  </tr>
  </thead>
  <tbody>
    <tr>
    <th>operations</th>
    <td><code class="type">[Operation]</code></td>
    <td><p>An array of <code>Operation</code> subclasses to be estimated.</p>
</td>
</tr>
<tr>
    <th>operation​Metadata</th>
    <td><code class="type">Operation​Metadata</code></td>
    <td><p>An <code>OperationMetadata</code> object containing necessary info about the current blockchain state.</p>
</td>
</tr>
<tr>
    <th>network​Constants</th>
    <td></td>
    <td><p>A <code>NetworkConstants</code> used to provide information about the current network requirements.</p>
</td>
</tr>
<tr>
    <th>with​Wallet</th>
    <td></td>
    <td><p>The <code>Wallet</code> object used for signing the transaction.</p>
</td>
</tr>
<tr>
    <th>completion</th>
    <td><code class="type">@escaping ((Result&lt;Estimation​Result, Kukai​Error&gt;) -&gt; Void)</code></td>
    <td><p>A callback containing the same operations passed in, modified to include fees.</p>
</td>
</tr>
  </tbody>
</table>
</div>
<div role="article" class="function" id="feeestimatorservice.extractfees(fromoperationresponse:forgedhash:withconstants:)">
    <h3>
        <code><a href="#feeestimatorservice.extractfees(fromoperationresponse:forgedhash:withconstants:)">extract​Fees(from​Operation​Response:​forged​Hash:​with​Constants:​)</a></code>
    </h3>
    <div class="declaration">
<pre class="highlight"><code><html><body><span class="keyword">public</span> <span class="keyword">func</span> <span class="function">extractFees</span>(<span class="variable">fromOperationResponse</span> <span class="variable">operationResponse</span>: <a href="https://kukai-core-swift.kukai.app/OperationResponse"><span class="type">OperationResponse</span></a>, <span class="variable">forgedHash</span>: <span class="type">String</span>, <span class="variable">withConstants</span> <span class="variable">constants</span>: <a href="https://kukai-core-swift.kukai.app/NetworkConstants"><span class="type">NetworkConstants</span></a>) -&gt; [<a href="https://kukai-core-swift.kukai.app/OperationFees"><span class="type">OperationFees</span></a>]  </body></html></code></pre>
</div>
<div class="summary" role="doc-abstract">
    <p>Create an array of <code>OperationFees</code> from an <code>OperationResponse</code>.</p>

</div>
<h4>Parameters</h4>

<table class="parameters">
  <thead hidden>
  <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
  </tr>
  </thead>
  <tbody>
    <tr>
    <th>from​Operation​Response</th>
    <td><code class="type">Operation​Response</code></td>
    <td><p>The <code>OperationResponse</code> resulting from an RPC call to <code>.../run_operation</code>.</p>
</td>
</tr>
<tr>
    <th>forged​Hash</th>
    <td><code class="type">String</code></td>
    <td><p>The forged hash string resulting from a call to <code>TezosNodeClient.forge(...)</code></p>
</td>
</tr>
  </tbody>
</table>
  <h4>Returns</h4>
  <p>An array of <code>OperationFees</code></p>

</div>
<div role="article" class="function" id="feeestimatorservice.feeforgas(_:)">
    <h3>
        <code><a href="#feeestimatorservice.feeforgas(_:)">fee​For​Gas(_:​)</a></code>
    </h3>
    <div class="declaration">
<pre class="highlight"><code><html><body><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">func</span> <span class="function">feeForGas</span>(<span class="keyword">_</span> <span class="variable">gas</span>: <span class="type">Int</span>) -&gt; <a href="https://kukai-core-swift.kukai.app/XTZAmount"><span class="type">XTZAmount</span></a>  </body></html></code></pre>
</div>
<div class="summary" role="doc-abstract">
    <p>Calculate the fee to add for the given amount of gas</p>

</div>
</div>
<div role="article" class="function" id="feeestimatorservice.feeforstorage(_:numberofoperations:)">
    <h3>
        <code><a href="#feeestimatorservice.feeforstorage(_:numberofoperations:)">fee​For​Storage(_:​number​OfOperations:​)</a></code>
    </h3>
    <div class="declaration">
<pre class="highlight"><code><html><body><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">func</span> <span class="function">feeForStorage</span>(<span class="keyword">_</span> <span class="variable">forgedHexString</span>: <span class="type">String</span>, <span class="variable">numberOfOperations</span>: <span class="type">Int</span>) -&gt; <a href="https://kukai-core-swift.kukai.app/XTZAmount"><span class="type">XTZAmount</span></a>  </body></html></code></pre>
</div>
<div class="summary" role="doc-abstract">
    <p>Calculate the fee to add based on the size of the forged string</p>

</div>
</div>
<div role="article" class="function" id="feeestimatorservice.feeforburn(_:withconstants:)">
    <h3>
        <code><a href="#feeestimatorservice.feeforburn(_:withconstants:)">fee​For​Burn(_:​with​Constants:​)</a></code>
    </h3>
    <div class="declaration">
<pre class="highlight"><code><html><body><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">func</span> <span class="function">feeForBurn</span>(<span class="keyword">_</span> <span class="variable">burn</span>: <span class="type">Int</span>, <span class="variable">withConstants</span> <span class="variable">contants</span>: <a href="https://kukai-core-swift.kukai.app/NetworkConstants"><span class="type">NetworkConstants</span></a>) -&gt; <a href="https://kukai-core-swift.kukai.app/XTZAmount"><span class="type">XTZAmount</span></a>  </body></html></code></pre>
</div>
<div class="summary" role="doc-abstract">
    <p>Calculate the fee to add based on how many bytes of storage where needed</p>

</div>
</div>
<div role="article" class="function" id="feeestimatorservice.nanoteztoxtz(_:)">
    <h3>
        <code><a href="#feeestimatorservice.nanoteztoxtz(_:)">nano​Tezto​XTZ(_:​)</a></code>
    </h3>
    <div class="declaration">
<pre class="highlight"><code><html><body><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">func</span> <span class="function">nanoTeztoXTZ</span>(<span class="keyword">_</span> <span class="variable">nanoTez</span>: <span class="type">NanoTez</span>) -&gt; <a href="https://kukai-core-swift.kukai.app/XTZAmount"><span class="type">XTZAmount</span></a>  </body></html></code></pre>
</div>
<div class="summary" role="doc-abstract">
    <p>Most calcualtions are documented in NanoTez, which is not accpeted by the network RPC calls. Needs to be converted to Mutez / XTZ</p>

</div>
</div>
<div role="article" class="function" id="feeestimatorservice.fee(forgaslimit:forgedhexstring:numberofoperations:)">
    <h3>
        <code><a href="#feeestimatorservice.fee(forgaslimit:forgedhexstring:numberofoperations:)">fee(for​Gas​Limit:​forged​Hex​String:​number​OfOperations:​)</a></code>
    </h3>
    <div class="declaration">
<pre class="highlight"><code><html><body><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">func</span> <span class="function">fee</span>(<span class="variable">forGasLimit</span> <span class="variable">gasLimit</span>: <span class="type">Int</span>, <span class="variable">forgedHexString</span>: <span class="type">String</span>, <span class="variable">numberOfOperations</span>: <span class="type">Int</span>) -&gt; <a href="https://kukai-core-swift.kukai.app/XTZAmount"><span class="type">XTZAmount</span></a>  </body></html></code></pre>
</div>
</div>
<div role="article" class="function" id="feeestimatorservice.addgassafetymarginto(gasused:)">
    <h3>
        <code><a href="#feeestimatorservice.addgassafetymarginto(gasused:)">add​Gas​Safety​Margin​To(gas​Used:​)</a></code>
    </h3>
    <div class="declaration">
<pre class="highlight"><code><html><body><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">func</span> <span class="function">addGasSafetyMarginTo</span>(<span class="variable">gasUsed</span>: <span class="type">Int</span>) -&gt; <span class="type">Int</span>  </body></html></code></pre>
</div>
</div>
    </section>



        </article>
    </main>

    <footer>
        <p>
    Generated on <time datetime="2023-09-25T14:49:09+0000">September 25, 2023</time> using <a href="https://github.com/SwiftDocOrg/swift-doc">swift-doc</a> <span class="version">1.0.0-rc.1</span>.
</p>
    </footer>
</body>
</html>
